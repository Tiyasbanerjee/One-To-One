<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Client 2</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        textarea { width: 100%; height: 120px; margin-top: 10px; }
        button { padding: 10px 15px; margin-top: 10px; }
        .box { margin-bottom: 20px; }
    </style>
</head>
<body>

<h2>Client 2 (Answer)</h2>

<div class="box">
    <textarea id="offer" placeholder="Paste offer here"></textarea>
    <button id="setOffer">Set Offer</button>
</div>

<div class="box">
    <textarea id="answer" placeholder="Generated answer"></textarea>
    <button id="createAnswer">Create Answer</button>
</div>

<hr>

<div class="box">
    <textarea id="chat" placeholder="Chat messages..." readonly></textarea>
    <input type="text" id="msg" placeholder="Type messageâ€¦">
    <button id="send">Send</button>
</div>

<script>
let pc = new RTCPeerConnection();
let channel;

pc.ondatachannel = (event) => {
    channel = event.channel;
    channel.onmessage = (e) => {
        chat.value += "Peer: " + e.data + "\n";
    };
};

setOffer.onclick = async () => {
    let off = JSON.parse(offer.value);
    await pc.setRemoteDescription(off);
};

createAnswer.onclick = async () => {
    let ans = await pc.createAnswer();
    await pc.setLocalDescription(ans);
    answer.value = JSON.stringify(ans);
};

pc.onicecandidate = (e) => {
    if (e.candidate === null) {
        answer.value = JSON.stringify(pc.localDescription);
    }
};

send.onclick = () => {
    let text = msg.value;
    channel.send(text);
    chat.value += "Me: " + text + "\n";
    msg.value = "";
};
</script>

</body>
</html>
